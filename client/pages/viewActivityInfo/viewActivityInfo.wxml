<!--client/pages/viewActivityInfo/viewActivityInfo.wxml-->
<view class="father">
  <!-- <canvas canvas-id='icon-background' class="icon-background-canvas"> </canvas> -->
  <view name="activityPic" class="pic-block">
    <image class="pic" src="{{activityInfo.imgUrl}}" mode="aspectFill"></image>
  </view>
  <view class="title">
    {{activityInfo.title}}
  </view>

  <view class="info-block">
    <view wx:if="{{activityInfo.createTime}}" class="info-in-top-block">
      <view class="info-title">发起时间：</view>
      <view class="info-text">{{activityInfo.createTime}}</view>
    </view>
    <view wx:if="{{activityInfo.startTime}}" class="info-in-block">
      <view class="info-title">开始时间：</view>
      <view class="info-text">{{activityInfo.startTime}}</view>
    </view>
    <view wx:if="{{activityInfo.introduction}}" class="info-in-block">
      <view class="info-title">简要介绍:</view>
      <view class="info-text">{{activityInfo.introduction}}</view>
    </view>
    <view wx:if="{{activityInfo.creditLimit}}" class="info-in-block">
      <view class="info-title">信用限制:</view>
      <view class="info-text">{{activityInfo.creditLimit}}</view>
    </view>
    <view wx:if="{{activityInfo.averageSkills}}" class="info-in-block">
      <view class="info-title">平均战力:</view>
      <view class="info-text">{{activityInfo.averageSkills}}</view>
    </view>
    <view style='clear:both;'></view>
  </view>

  <view class="info-block">
    <view class="info-intro">参与者：</view>
    <view class="join-chat" bindtap="joinChat" wx:if="hasJoined">加入聊天室</view>
    <view class="members-block">
      <view wx:for="{{membersArray}}">
        <view wx:if="{{index<5}}">
          <image catchtap="viewMemberInfo" class="avatar" src="{{item.avatarUrl}}" data-uid="{{item.uid}}" mode="aspectFill" />
        </view>
        <view wx:elif="{{index==5}}">
          <view class="avatar-more">
            <image catchtap="viewMemberInfo" class="avatar-more-image" src="../../images/more.png" data-uid="{{item.uid}}" mode="aspectFill" />
          </view>
        </view>
      </view>
    </view>
    <view style='clear:both;'></view>
  </view>

  <view class="info-block">
    <view class="info-intro">详细说明：</view>
    <view class="description-text">详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说明详细说</view>
    <view style='clear:both;'></view>
  </view>

  <view style='height:200rpx;'></view>

  <view class="canvas">
    <image class="canvas-image" src="../../images/篮球.png"></image>
  </view>
</view>

<view>
  <view wx:if="{{((hasJoined)&&(activityInfo.status==0))}}" class="join">准备中</view>
  <view wx:elif="{{(!isFull)&&(activityInfo.status==0)}}" class="join" bindtap="joinActivity">参加活动</view>
  <view wx:elif="{{(isFull)&&(activityInfo.status==0)}}" class="join">活动已满</view>
  <view wx:elif="{{(isOwner&&(activityInfo.status==1))}}" class="join" bindtap="endActivity">结束活动</view>
  <view wx:elif="{{(!isOwner)&&(activityInfo.status==1)}}" class="join">进行中</view>
  <view wx:elif="{{(hasJoined)&&(!hasEvaluated)&&(activityInfo.status==2)}}" class="join" bindtap="evaluateActivity">评价
    <!-- <canvas class="join-mask" canvas-id='joinMask2'></canvas>
    <canvas class="join-mask" canvas-id='joinMask'></canvas> -->
  </view>
  <view wx:elif="{{(activityInfo.status==2)}}" class="join">已结束</view>
</view>

<view catchtap='showMoreOptions'>
  <image src="../../images/more.png" class="more"></image>
</view>

<view wx:if="{{evaluating}}">
  <view class="sub-mask"></view>
  <swiper interval="5000" duration="1000" class="evaluate-swiper" next-margin='150rpx'>
    <swiper-item wx:for="{{membersArray}}" wx:key="{{item.uid}}" class="evaluate-item">
      <view class="evaluate-block">
        <image class="avatar" src="{{item.avatarUrl}}" data-uid="{{item.uid}}" mode="aspectFill" />
        <button>up</button>
        <button>down</button>
      </view>
    </swiper-item>
  </swiper>
  <view class="join" catchtap='completeEvaluateActivity'>完成</view>
</view>

<view wx:if="{{ending}}">
  <view class="sub-mask"></view>
  <view class="end-block">
    <view wx:for="{{membersArray}}">
      <image catchtap="sign" wx:if="{{!item.signed}}" class="avatar-unsigned" src="{{item.avatarUrl}}" data-uid="{{item.uid}}" mode="aspectFill" />
      <image catchtap="sign" wx:if="{{item.signed}}" class="avatar-signed" src="{{item.avatarUrl}}" data-uid="{{item.uid}}" mode="aspectFill" />
    </view>
  </view>
  <view class="join" catchtap='completeEndActivity'>完成</view>
</view>


<view wx:if="{{transfering}}">
  <view class="sub-mask"></view>
  <view class="end-block">
    <view wx:for="{{membersArray}}">
      <image catchtap="chooseTransfer" wx:if="{{(myUid != item.uid)&&(transferTo == item.uid)}}" class="avatar-signed" src="{{item.avatarUrl}}" data-uid="{{item.uid}}" mode="aspectFill" />
      <image catchtap="chooseTransfer" wx:elif="{{myUid != item.uid}}" class="avatar-unsigned" src="{{item.avatarUrl}}" data-uid="{{item.uid}}" mode="aspectFill" />
    </view>
  </view>
  <view class="join" catchtap='completeTransfer'>完成</view>
</view>